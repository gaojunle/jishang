<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta content="yes" name="apple-touch-fullscreen">
    <meta content="telephone=no,email=no" name="format-detection">
    <title>远洋天著春秋服务平台</title>
    <script type="text/javascript" src="./js/lib/flexible.js"></script>
    <link rel="stylesheet" href="./css/page/login.css">
</head>
<body>
<div class="auth-logo-box">
    <img src="./img/common/logo.png" alt="">
</div>
<section class="check-info">
    <form action="api/submit" id="suform">
        <p class="get-code"><input type="text" name="mobile" class="js-mobile" placeholder="请输入您的手机号">
            <a href="#" class="btn-get-code">获取验证码</a>
        </p>
        <p><input type="text" name="code" placeholder="请输入您收到验证码"></p>
        <div class="btn-box"><input type="submit" class="weui-btn weui-btn_primary js-submit" value="提交验证"></div>
    </form>
</section>

<script src="js/lib/jquery-2.1.4.min.js"></script>
<script src="js/lib/jquery-weui.min.js"></script>
<script src="js/lib/jquery.validate.js"></script>
<script>
    jQuery(function ($) {
        var $getCode = $('.btn-get-code');
        $('.js-mobile').on('keyup', function () {
            var val = $(this).val();

            if (/^1[3|4|5|7|8|9][0-9]\d{8}$/.test(val) && !$('.btn-get-code').data('istime')) {
                $getCode.addClass('active')
            }
        });

        $getCode.click(function () {
            var $this = $(this),
                countDown = 60;

            if (!$this.data('istime') && $this.hasClass('active')) {
                //TODO 发送请求获取验证码
                //alert('发送请求获取验证码');
                $this.removeClass('active');
                $this.html('发送中(' + countDown-- + ')');
                $this.data('istime', setInterval(function () {
                    if (countDown == 0) {
                        clearInterval($this.data('istime'));
                        $this.data('istime', false).addClass('active');
                        $this.html('获取验证码');
                        return false;
                    }
                    $this.html('发送中(' + countDown-- + ')');
                }, 1000));
            }
        });

        $("#suform").validate({
            submitHandler: function (form) {
                //form.submit();
                $.alert("登录成功", "", function() {
                    location.href = "身份认证.html"
                });
            },
            rules: {
                mobile: "required",
                code: {
                    required: true,
                    minlength: 4
                }
            },
            messages: {
                name: "请输入您的名字",
                mobile: "请输入您的手机号",
                code: {
                    required: "请输入验证码",
                    minlength: "验证码长度不能小于 4 个字母"
                }
            }
        });
    })
</script>
</body>
</html>