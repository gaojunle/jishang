<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>首页</title>
    <meta name="keywords" content="首页" />
    <meta name="description" content="首页" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="x5-fullscreen" content="true">
    <meta name="full-screen" content="yes">
    <link rel="shortcut icon" href="./img/common/favicon.ico" />
    <link rel="apple-touch-icon-precomposed" href="./img/common/favicon.ico" />
    <link rel="stylesheet" href="./css/page/home_v2.css" />
    <link rel="stylesheet" href="./css/lib/swiper.min.css">
    <script src="./js/lib/flexible.js"></script>
</head>

<body>
    <div class="wrap-box">
        <div class="top">
            <div class="banner-swiper">
                <ul class="swiper-wrapper">
                    <li class="swiper-slide"><a href="javascript:;"><img src="./img/index/banner.png" /></a></li>
                    <li class="swiper-slide"><a href="javascript:;"><img src="./img/index/banner.png" /></a></li>
                    <li class="swiper-slide"><a href="javascript:;"><img src="./img/index/banner.png" /></a></li>
                </ul>
                <div class="swiper-pagination"></div>
            </div>
            <div class="info">
                <div class="default">
                    <h3>阳光美好的小情节</h3>
                    <a class="btn_active" href="javascript:;">立即激活</a>
                </div>
                <a href="#" class="actived">
                    <h3>程XX</h3>
                    <div>
                        <span class="mark">业主</span>
                        <p>天津公元大观3号院101栋2001号</p>
                    </div>
                </a>
                <img class="btn_scode" src="./img/index/scode.png" alt="">
            </div>
            <div class="split"></div>
        </div>

        <div class="container">
            <div class="link-box link-swiper">
                <div class="link-panel swiper-slide">
                    <div class="items">
                        <a href="#" class="item">
                            <img src="./img/index/icons/1_zsqy.png" alt="">
                            <span>专属权益</span>
                        </a>
                        <img class="split" src="./img/index/sp2.png" alt="">
                        <a href="#" class="item">
                            <img src="./img/index/icons/2_yhq.png" alt="">
                            <span>优惠券</span>
                        </a>
                        <img class="split" src="./img/index/sp2.png" alt="">
                        <a href="#" class="item">
                            <img src="./img/index/icons/3_rfhd.png" alt="">
                            <span>融粉活动</span>
                        </a>
                    </div>
                    <img class="split_bg" src="./img/index/sp1.png" alt="" />
                    <div class="items">
                        <a href="#" class="item">
                            <img src="./img/index/icons/4_rxlp.png" alt="">
                            <span>热销楼盘</span>
                        </a>
                        <img class="split" src="./img/index/sp2.png" alt="">
                        <a href="#" class="item">
                            <img src="./img/index/icons/5_gcjd.png" alt="">
                            <span>工程进度</span>
                        </a>
                        <img class="split" src="./img/index/sp2.png" alt="">
                        <a href="#" class="item">
                            <img src="./img/index/icons/6_bsbx.png" alt="">
                            <span>报事报修</span>
                        </a>
                    </div>
                    <img class="split_bg" src="./img/index/sp1.png" alt="" />
                    <div class="items">
                        <a href="#" class="item">
                            <img src="./img/index/icons/7_wjdy.png" alt="">
                            <span>问卷调研</span>
                        </a>
                        <img class="split" src="./img/index/sp2.png" alt="">
                        <a href="#" class="item">
                            <img src="./img/index/icons/8_gxkj.png" alt="">
                            <span>共享空间</span>
                        </a>
                        <img class="split" src="./img/index/sp2.png" alt="">
                        <a href="#" class="item">
                            <img src="./img/index/icons/9_wyjf.png" alt="">
                            <span>物业缴费</span>
                        </a>
                    </div>
                    <img class="split_bg" src="./img/index/sp1.png" alt="" />
                    <div class="items">
                        <a href="#" class="item">
                            <img src="./img/index/icons/10_rfkt.png" alt="">
                            <span>融粉课堂</span>
                        </a>
                        <img class="split" src="./img/index/sp2.png" alt="">
                        <a href="#" class="item">
                            <img src="./img/index/icons/11_gdkf.png" alt="">
                            <span>工地开放</span>
                        </a>
                        <img class="split" src="./img/index/sp2.png" alt="">
                        <a href="#" class="item">
                            <img src="./img/index/icons/12_rfzy.png" alt="">
                            <span>融粉庄园</span>
                        </a>
                    </div>
                    <img class="split_bg" src="./img/index/sp1.png" alt="" />
                    <div class="items">
                        <a href="#" class="item">
                            <img src="./img/index/icons/13_wdxz.png" alt="">
                            <span>我的勋章</span>
                        </a>
                        <img class="split" src="./img/index/sp2.png" alt="">
                        <a href="#" class="item">
                            <img src="./img/index/icons/14_ryjkht.png" alt="">
                            <span>融一家会客厅</span>
                        </a>
                        <img class="split" src="./img/index/sp2.png" alt="">
                        <a href="#" class="item">
                            <img src="" alt="">
                            <span></span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
        <div class="arrowUp"><img src="./img/index/arrowUP.gif" alt=""><img src="./img/index/arrowUP.gif" alt=""></div>
    </div>
    <!-- <div class="log" style="position: fixed;top:0px;width: 100%;left: 0px;"></div> -->
    <div class="footer">
        <a href="#" class="on">首页</a>
        <a href="#">联系客服</a>
        <a href="#">个人中心</a>
    </div>
    </div>
    <script src="./js/lib/jquery.min.js"></script>
    <script src="./js/lib/artDialog.js"></script>
    <script src="./js/lib/swiper.min.js"></script>
    <script>
        jQuery(function ($) {
            var App = {
                init: function () {
                    this.initData();
                    this.bindEvent();
                    this.initBaoXiang();
                    this.scrollAnimate();
                },
                bindEvent: function () {
                    //TODO 测试使用，info的div上加 activated 类名表示激活
                    $('.btn_active').click(function () {
                        $(this).parents('.info').addClass('activated')
                    })

                    $('.btn_scode').click(function () {
                        var d = dialog({
                            title: '',
                            padding: 0,
                            content: '<div class="pop-cont"><img class="icon_close" src="./img/index/icon_close.png" alt=""><p><img class="scode-avt" src="./img/index/scode-avt.png" alt=""></p></div>',
                            backdropOpacity: '0.3'
                        });
                        d.showModal();
                        $('.icon_close').click(function () {
                            d.close().remove();
                        })
                    })
                },
                scrollAnimate: function () {
                    function preventDefaultScrollDown(e) {
                        e.preventDefault()
                    }
                    document.body.addEventListener('touchmove', preventDefaultScrollDown, { passive: false });                    

                    var startx, starty;
                    //获得角度
                    function getAngle(angx, angy) {
                        return Math.atan2(angy, angx) * 180 / Math.PI;
                    };

                    //根据起点终点返回方向 1向上 2向下 3向左 4向右 0未滑动
                    function getDirection(startx, starty, endx, endy) {
                        var angx = endx - startx;
                        var angy = endy - starty;
                        var result = 0;

                        //如果滑动距离太短
                        if (Math.abs(angx) < 2 && Math.abs(angy) < 2) {
                            return result;
                        }

                        var angle = getAngle(angx, angy);
                        if (angle >= -135 && angle <= -45) {
                            result = 1;
                        } else if (angle > 45 && angle < 135) {
                            result = 2;
                        } else if ((angle >= 135 && angle <= 180) || (angle >= -180 && angle < -135)) {
                            result = 3;
                        } else if (angle >= -45 && angle <= 45) {
                            result = 4;
                        }

                        return result;
                    }
                    //手指接触屏幕
                    document.addEventListener("touchstart", function (e) {
                        startx = e.touches[0].pageX;
                        starty = e.touches[0].pageY;
                    }, false);

                    //手指离开屏幕
                    document.addEventListener("touchmove", function (e) {
                        var endx, endy;
                        endx = e.changedTouches[0].pageX;
                        endy = e.changedTouches[0].pageY;
                        var direction = getDirection(startx, starty, endx, endy);
                        switch (direction) {
                            case 0:
                                //alert("未滑动！");
                                break;
                            case 1:
                                //向上
                                $('.wrap-box .top').addClass('swiperUp');

                                setTimeout(function () {
                                    if (!$('.wrap-box').hasClass('swiperUp')) {
                                        $('.container').scrollTop(5);
                                        $('.wrap-box').addClass('swiperUp');
                                        document.body.removeEventListener('touchmove', preventDefaultScrollDown, { passive: true });
                                    }
                                }, 1000)
                                $('.arrowUp').addClass('rotate180');
                                break;
                            case 2:
                                //向下
                                if ($('.container').scrollTop() < 5) {
                                    document.body.addEventListener('touchmove', preventDefaultScrollDown, { passive: false });   
                                    $('.wrap-box').removeClass('swiperUp');
                                    //$('.container').scrollTop(0);
                                    $('.wrap-box .top').removeClass('swiperUp');
                                    $('.arrowUp').removeClass('rotate180');                           
                                }

                                break;
                            case 3:
                                //alert("向左！")
                                break;
                            case 4:
                                //alert("向右！")
                                break;
                            default:
                        }
                    });
                },
                initData: function () {
                    this.initSwiper();
                },

                initSwiper: function () {
                    var swiperBanner = new Swiper('.banner-swiper', {
                        spaceBetween: 0,
                        centeredSlides: true,
                        autoplay: 4000,
                        loop: true,
                        pagination: '.swiper-pagination'
                    });
                    var linkSwiper = new Swiper('.link-swiper', {
                        spaceBetween: 0,
                        nextButton: '.swiper-button-next',
                        prevButton: '.swiper-button-prev',
                    });
                },

                initBaoXiang: function () {

                }
            };
            App.init();
        })
    </script>
</body>

</html>